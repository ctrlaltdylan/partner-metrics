<%= polaris_layout do |layout| %>
  <% layout.with_section(one_half: true) do %>
    <%= polaris_card(title: "Recurring per app (Last 12 Months)") do %>
      <%= column_chart current_user.yearly_revenue_per_product(charge_type: "recurring_revenue", date: date) %>
    <% end %>
  <% end %>
  <% layout.with_section(one_half: true) do %>
    <%= polaris_card(title: "Recurring per app (Last 12 Months)") do %>
      <%= pie_chart current_user.yearly_revenue_per_product(charge_type: "recurring_revenue", date: date) %>
    <% end %>
  <% end %>
<% end %>

<% per_plan = current_user.payment_histories.where(
  charge_type: "recurring_revenue",
  app_title: selected_app,
  payment_date: (date - period.days)..date).group(:revenue).order('revenue DESC').count
%>

<%= polaris_layout do |layout| %>
  <% layout.with_section(one_half: true) do %>
    <%= polaris_card(title: "Users per plan (Last #{period} days)") do %>
      <p>Last #{period} days</p>
      <%= column_chart per_plan %>
    <% end %>
  <% end %>
  <% layout.with_section(one_half: true) do %>
    <%= polaris_card(title: "Recurring per app (All time)") do %>
      <%= pie_chart per_plan %>
    <% end %>
  <% end %>
<% end %>
